<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Main App</title>

    <!-- BootStrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Google Maps -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.2/pure-min.css">

    <!-- Axios API -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <!-- ChartJS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.8.0/chart.min.js"></script>

    <!--Aplication-->
    <script type="text/javascript" src="../libs/request_handler.js"></script>
    <script type="text/javascript" src="../libs/dom_deliver.js"></script>
    <script src="../libs/graph.js"></script>
    <link href="../styles/main.css" rel="stylesheet">
    <link href="../styles/map.css" rel="stylesheet">
    <link href="../styles/navbar.css" rel="stylesheet">
    <link href="../styles/card.css" rel="stylesheet">

</head>
<body id="main" class="" onload='getInfo(true, "")'>
  <div id="loader" class="overlay" style="z-index: 100000;" data-app-menu-active="true">
    <div class="lds-ring center"><div></div><div></div><div></div><div></div></div>
  </div>

  <div class="overlay" style="z-index: 100000;" data-app-menu-active="false">
    <div class="position-absolute translate-middle top-50 start-50">
      <div class="light rounded-3 p-3 mt-3 shadow-sm" style="width: 20rem; height: 40rem;">
        Text
      </div>
    </div>
  </div>
  
  <div id="confirmPromotion">
    
  </div>

  <nav class="app-navbar">
    <ul class="app-navbar-nav">

      <li class="app-nav-item" onclick="toggleDrawing(false)">
        <a class="app-nav-link grow" data-bs-toggle="offcanvas" data-bs-target="#user-properties">
          <div class="avatar-wrapper d-flex" data-user="" style="width: 2rem; height: 2rem;">
            <img id="usr_avatar_navbar" src="../media/imgs/user.png" class="rounded-circle shadow-sm user-avatar">
          </div>
          <span class="app-link-text">
            Perfil
          </span>
        </a>
      </li>

      <li id="community-app-nav-item" class="app-nav-item" onclick="toggleDrawing(false)">
        <a class="app-nav-link grow" data-bs-toggle="offcanvas" data-bs-target="#community">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-people-fill" viewBox="0 0 16 16">
            <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
            <path fill-rule="evenodd" d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z"/>
            <path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/>
          </svg>
          <span class="app-link-text">
            Comunidade
          </span>
        </a>
      </li>

      <!-- <li class="app-nav-item" onclick="toggleDrawing(false)">
        <a class="app-nav-link grow" data-bs-toggle="offcanvas" data-bs-target="#search-user" aria-controls="offcanvasScrolling" data-tooltip="Pesquisar">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
          </svg>
          <span class="app-link-text">
            Pesquisar
          </span>
        </a>
      </li> -->

      <li class="app-nav-item" onclick="toggleDrawing(false)" data-app-menu-active="true">
        <a class="app-nav-link grow" data-bs-toggle="offcanvas" data-tooltip="Mostrar o mapa">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-geo-alt-fill" viewBox="0 0 16 16">
            <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
          </svg>
          <span class="app-link-text">
            Mapa
          </span>
        </a>
      </li>

      <li class="app-nav-item" onclick="toggleDrawing(false)">
        <a class="app-nav-link grow" data-bs-toggle="offcanvas" data-bs-target="#list-properties" aria-controls="offcanvasScrolling" data-tooltip="Adicionar uma Propriedade">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-pin-map" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M3.1 11.2a.5.5 0 0 1 .4-.2H6a.5.5 0 0 1 0 1H3.75L1.5 15h13l-2.25-3H10a.5.5 0 0 1 0-1h2.5a.5.5 0 0 1 .4.2l3 4a.5.5 0 0 1-.4.8H.5a.5.5 0 0 1-.4-.8l3-4z"/>
            <path fill-rule="evenodd" d="M8 1a3 3 0 1 0 0 6 3 3 0 0 0 0-6zM4 4a4 4 0 1 1 4.5 3.969V13.5a.5.5 0 0 1-1 0V7.97A4 4 0 0 1 4 3.999z"/>
          </svg>
          <span class="app-link-text">
            Terrenos
          </span>
        </a>
      </li>

      <li class="app-nav-item dropup" onclick="toggleDrawing(false)">
        <a class="app-nav-link grow" data-bs-toggle="dropdown" id="notifications-btn" aria-expanded="false">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-bell-fill" viewBox="0 0 16 16">
            <path d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2zm.995-14.901a1 1 0 1 0-1.99 0A5.002 5.002 0 0 0 3 6c0 1.098-.5 6-2 7h14c-1.5-1-2-5.902-2-7 0-2.42-1.72-4.44-4.005-4.901z"/>
          </svg>
          <span class="app-link-text">
            Notificações
          </span>
        </a>
        <ul id="usr_list_notification" class="dropdown-menu mt-3" aria-labelledby="notifications-btn">
        </ul>
      </li>

      <li class="app-nav-item dropup" onclick="toggleDrawing(false)">
        <a class="app-nav-link grow" data-bs-toggle="dropdown" id="settings-btn" aria-expanded="false">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-gear-fill" viewBox="0 0 16 16">
            <path d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872l-.1-.34zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z"/>
          </svg>
          <span class="app-link-text">
            Definições
          </span>
          
        </a>
        <ul class="dropdown-menu" aria-labelledby="settings-btn">
          <!-- Dropdown menu links -->
          <li><a class="dropdown-item disabled" href="#">Tema</a></li>

          <li><a class="dropdown-item" href="#" onclick="toggleDrawing(false);logout()">Logout</a></li>
        </ul>
      </li>
    </ul>
  </nav>

  <main>
        <!-- Maps -->
        <div id="map" class=""></div>
        <script src="../libs/maps.js"></script>
        <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDFF-sduDxFSBjCD_C-leaSI-sTkoCNO6Y&callback=initMap&libraries=drawing"></script>

        
  </main>

  <!-- User Properties Offcanvas -->
  <div class="offcanvas offcanvas-start bg-light rounded-3 border-0 shadow-sm" style="" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-5" id="user-properties" aria-labelledby="offcanvasScrollingLabel">
    <div class="offcanvas-header position-relative light shadow-sm">
      <h4 class="ms-3">Perfil</h4>
      <a type="button" class="btn-close text-reset position-absolute end-0 translate-middle-x" data-bs-dismiss="offcanvas" aria-label="Close"></a>
    </div>
    <div id="usr_menu" class="offcanvas-body" data-app-menu-active="true">
      
      <div class="row">
        <div class="col-md-5 col-sm-12">
          <div class="row flex-column ">
            <div class="col-12">
              <div id="usr_credentials_scrollspy" class="position-relative light rounded-3 p-3 m-1 shadow-sm">
                <div class="d-flex flex-row m-3 align-items-center">
                  <div class="avatar-wrapper d-flex" data-user="" style="width: 7rem; height: 7rem;">
                    <img id="usr_avatar_perfil_credentials" src="../media/imgs/user.png" class="rounded-circle shadow-sm user-avatar">
                  </div>
                  <div class="ms-3">
                    <h4 id="usr_username">Username</h4>
                    <p style="font-size: 13px;" id="usr_email" class="mb-1">Email</p>
                    <div id="usr_roles_menu">
                    </div>
                  </div>
                </div>
               
              </div>
            </div>
            <div class="col-12">
              <div id="usr_perfil_scrollspy" class="light rounded-3 p-3 m-1 shadow-sm ">
                <div class="position-relative perfil-header mb-3">
                  <h5 class="">Perfil</h5>
                  <div class="position-absolute end-0 top-50 translate-middle-y">
                    <div id="btn_change_usr_profile_not_active" data-app-menu-active="true">
                      <a id="btn_change_usr_profile" class="text-reset change-usr-profile" href="#" onclick="toggleChangeProfileMenu('usr_profile_menu', 'usr_change_profile_menu', 'btn_change_usr_profile_not_active', 'btn_change_usr_profile_active')">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-pen" viewBox="0 0 16 16">
                          <path d="m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001zm-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708l-1.585-1.585z"/>
                        </svg>
                        
                      </a> 
                    </div>
                    
                    <div id="btn_change_usr_profile_active" data-app-menu-active="false">
                      
      
                      <a class="text-reset change-usr-profile" href="#" onclick="updatePerfil(perfil);toggleChangeProfileMenu('usr_profile_menu', 'usr_change_profile_menu', 'btn_change_usr_profile_not_active', 'btn_change_usr_profile_active')">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16">
                          <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>
                        </svg>
                        
                      </a>
                      <a class="text-reset change-usr-profile" href="#" onclick="loader('usr_change_profile_menu','true');changing_att();">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-check2" viewBox="0 0 16 16" data-app-menu-active="true">
                          <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                        </svg>
                      </a>
                    </div>
                  </div>
                </div>
                <div id="usr_profile_menu" data-app-menu-active="true">
                  <h6>Nome Completo</h6>
                  <p id="usr_fullname" class="border-bottom">-</p>
                  <h6>NIF</h6>
                  <p id="usr_id" class="border-bottom">-</p>
                  <h6>Número de telefone</h6>
                  <p id="usr_telephone" class="border-bottom">-</p>
                  <h6>Número de smartphone</h6>
                  <p id="usr_smartphone" class="border-bottom">-</p>
                  <h6>Morada</h6>
                  <p id="usr_address" class="border-bottom">-</p>
                </div>
                <div id="usr_change_profile_menu" data-app-menu-active="false">
                  <h6>Nome Completo</h6>
                  <input id="usr_fullname_input" class="form-control rounded-pill mb-3" value="-"></input>
                  <h6>NIF</h6>
                  <input id="usr_id_input" class="form-control rounded-pill mb-3" value="-"></input>
                  <h6>Número de telefone</h6>
                  <input id="usr_telephone_input" class="form-control rounded-pill mb-3" value="-"></input>
                  <h6>Número de smartphone</h6>
                  <input id="usr_smartphone_input" class="form-control rounded-pill mb-3" value="-"></input>
                  <h6>Morada</h6>
                  <input id="usr_address_input" class="form-control rounded-pill mb-3" value="-"></input>
                  <h6>Imagem de Perfil</h6>
                  <input id="usr_avatar" type="file" accept="image/jpeg, image/png" onchange="loadAvatar(event)" class="form-control rounded-pill" placeholder="Avatar">
                  <br>
                  <div class="d-flex flex-row justify-content-center">
                    <span class="spinner-border spinner-border-sm text-primary" style="width: 2rem; height: 2rem;" role="status" aria-hidden="true" data-app-menu-active="false"></span>
                  </div>
                </div>
                
        
              </div>
            </div>
            
          </div>
        </div>
        <div class="col-md-7 col-sm-12">
          <div class="row flex-row">
            <div class="col-4">
              <div class="bg-success bg-opacity-25 rounded-3 p-3 m-1 shadow-sm">
                <h5 class="text-center">Terrenos</h5>
                <p class="display-6 text-center nmr_terrain">0</p>
              </div>
            </div>
            <div class="col-4">
              <div class="bg-info bg-opacity-25 rounded-3 p-3 m-1 shadow-sm">
                <h5 class="text-center">Área Total</h5>
                <p class="display-6 text-center">0</p>
              </div>
            </div>
            <div class="col-12">
              <div class="position-relative light rounded-3 p-3 m-1 shadow-sm ">
                <div class="position-relative mb-3">
                  <div class="d-flex flex-row" style="width: 100%;">
                    <h5 class="align-items-center">Procurar Utilizador</h5>
                    <div class="ms-3 input-group justify-content-end end-0 p-1 border rounded-pill" style="max-width: 15rem;">
                      <a class="text-reset btn border-0 rounded-pill" href="#" onclick="get()">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                          <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                        </svg>
                      </a>
                      <input id="search_list_user_input" class="form-control rounded-pill border-0 border-white"></input>
                      <div class="d-flex flex-row justify-content-center">
                        <span id="promote_spinner" class="ms-3 spinner-border spinner-border-sm text-primary align-self-center me-2" style="width: 1.5rem; height: 1.5rem;" role="status" aria-hidden="true" data-app-menu-active="false"></span>
                      </div>
                    </div>
                  </div>
                  
                </div>
                <ul id="list_search_users" class="list-group ms-2" style="width: 100%;" data-app-value=0>

                </ul>
        
              </div>
            </div>
          </div>

        </div>
      </div>

      <div class="d-flex justify-content-start">
      </div>

      <!-- Toast Handler-->
    </div>
    
    <div id="usr_change_password" class="offcanvas-body" data-app-menu-active="false">
      <div id="usr_credentials_scrollspy" class="light rounded-3 p-3 shadow-sm">
        <div class="d-flex flex-row justify-content-center mb-3">
          <div class="avatar-wrapper" data-user="" style="width: 8rem; height: 8rem;">
            <img id="usr_avatar_perfil" src="../media/imgs/user.png" class="rounded-circle shadow-sm" style="">
          </div>
          
        </div>
        <h3 id="usr_username">Username
        </h3>
        <h5 id="usr_email" class="">Email</h5>
        <div id="usr_roles_change_password">
        </div>
      </div>
      <div class="light rounded-3 p-3 mt-3 shadow-sm">
        <h6>Palavra-passe nova</h6>
        <input id="usr_new_password_change_password" class="form-control rounded-pill"></input>
        <br>
        <div class="d-flex flex-column justify-content-center">
          <div class="d-flex flex-row justify-content-center">
            <a id="btn_callback_change_usr_profile" onclick="toggleChangeProfileMenu('usr_change_password', 'usr_menu')" href="#" class="btn btn-danger m-3 btn-change-usr-profile" onclick="">Cancelar</a>
            <a href="#" class="btn btn-primary m-3" onclick="change_password()">Alterar</a>
          </div>
        </div>
      </div>
      
      <!-- Toast Handler-->
    </div>
  </div>

  <!-- Community Offcanvas -->
  <div class="offcanvas offcanvas-start bg-light rounded-3 border-0 shadow-sm" style="" data-bs-scroll="true" data-bs-backdrop="true" tabindex="-5" id="community" aria-labelledby="offcanvasScrollingLabel">
    <div class="offcanvas-header position-relative light shadow-sm">
      <h4 class="ms-3">Comunidade</h4>
      <a type="button" class="btn-close text-reset position-absolute end-0 translate-middle-x" data-bs-dismiss="offcanvas" aria-label="Close"></a>
    </div>
    <div class="row m-3">
      <div class="col-md-6 col-sm-12 align-items-center">
        <div class="light rounded-3 p-3 shadow-sm mt-3"></div>
      </div>
      <div class="col-md-6 col-sm-12 align-items-center">
        <div class="light rounded-3 p-3 shadow-sm mt-3"></div>
      </div>
    </div>
    
    
    <div id="usr_change_password" class="offcanvas-body" data-app-menu-active="false">
      <div id="usr_credentials_scrollspy" class="light rounded-3 p-3 shadow-sm">
        <div class="d-flex flex-row justify-content-center mb-3">
          <div class="avatar-wrapper" data-user="" style="width: 8rem; height: 8rem;">
            <img id="usr_avatar_perfil" src="../media/imgs/user.png" class="rounded-circle shadow-sm" style="">
          </div>
        </div>
        <h3 id="usr_username">Username
        </h3>
        <h5 id="usr_email" class="">Email</h5>
        <div id="usr_roles_change_password">
        </div>
      </div>
      <div class="light rounded-3 p-3 mt-3 shadow-sm">
        <h6>Palavra-passe nova</h6>
        <input id="usr_new_password_change_password" class="form-control rounded-pill"></input>
        <br>
        <div class="d-flex flex-column justify-content-center">
          <div class="d-flex flex-row justify-content-center">
            <a id="btn_callback_change_usr_profile" onclick="toggleChangeProfileMenu('usr_change_password', 'usr_menu')" href="#" class="btn btn-danger m-3 btn-change-usr-profile" onclick="">Cancelar</a>
            <a href="#" class="btn btn-primary m-3" onclick="change_password()">Alterar</a>
          </div>
        </div>
      </div>
      
      <!-- Toast Handler-->
    </div>
  </div>

  <!-- Statistics Offcanvas -->
  <div class="offcanvas offcanvas-start bg-light rounded-3 border-0 shadow-sm" style="" data-bs-scroll="true" data-bs-backdrop="true" tabindex="-5" id="stats" aria-labelledby="offcanvasScrollingLabel">
    <div class="offcanvas-header position-relative light shadow-sm">
      <h4 class="ms-3">Estatísticas</h4>
      <a type="button" class="btn-close text-reset position-absolute end-0 translate-middle-x" data-bs-dismiss="offcanvas" aria-label="Close"></a>
    </div>
    <div id="stats-menu" class="offcanvas-body" data-app-menu-active="true">


      <div class="row">
        <div class="col-md-6 col-sm-12">
          <div class="row flex-column">
            <div class="col-12">
              <div class="light rounded-3 p-3 m-1 shadow-sm">
                <h4>Área Total</h4>
                <canvas id="stats_total_area" style="height: 800px;"></canvas>
              </div>
            </div>
            <div class="col-12">
              <div class="position-relative light rounded-3 p-3 m-1 shadow-sm">
                <h4>Temperatura Ambiente</h4>
                <canvas id="stats_ambient_temperature" style="height: 800px;"></canvas>

              </div>
            </div>
          </div>
        </div>
        <div class="col-md-6 col-sm-12">
          <div class="row flex-column">
            <div class="col-12">
              <div class="position-relative light rounded-3 p-3 m-1 shadow-sm">
                <h4>Tipos de terrenos</h4>
                <canvas id="stats_types_terrain" style="height: 800px;"></canvas>
    
              </div>
            </div>
            <div class="col-12">
              <div class="position-relative light rounded-3 p-3 m-1 shadow-sm">
                <h4>Tipos de terrenos</h4>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <div id="usr_change_password" class="offcanvas-body" data-app-menu-active="false">
      <div id="usr_credentials_scrollspy" class="light rounded-3 p-3 shadow-sm">
        <div class="d-flex flex-row justify-content-center mb-3">
          <div class="avatar-wrapper" data-user="" style="width: 8rem; height: 8rem;">
            <img id="usr_avatar_perfil" src="../media/imgs/user.png" class="rounded-circle shadow-sm" style="">
          </div>
        </div>
        <h3 id="usr_username">Username
        </h3>
        <h5 id="usr_email" class="">Email</h5>
        <div id="usr_roles_change_password">
        </div>
      </div>
      <div class="light rounded-3 p-3 mt-3 shadow-sm">
        <h6>Palavra-passe nova</h6>
        <input id="usr_new_password_change_password" class="form-control rounded-pill"></input>
        <br>
        <div class="d-flex flex-column justify-content-center">
          <div class="d-flex flex-row justify-content-center">
            <a id="btn_callback_change_usr_profile" onclick="toggleChangeProfileMenu('usr_change_password', 'usr_menu')" href="#" class="btn btn-danger m-3 btn-change-usr-profile" onclick="">Cancelar</a>
            <a href="#" class="btn btn-primary m-3" onclick="change_password()">Alterar</a>
          </div>
        </div>
      </div>
      
      <!-- Toast Handler-->
    </div>
  </div>

  <!-- Help Offcanvas -->
  <div class="offcanvas offcanvas-bottom rounded-3 bg-light" style="z-index: 10; height: 100vh;" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="help-offcanvas" aria-labelledby="offcanvasScrollingLabel">
    <div class="offcanvas-header">
      <h4>Ajuda</h4>
      <button type="button" class="btn-close text-reset position-absolute end-0 translate-middle-x" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
      
      <p> Tutorial of this application </p>
      
    </div>
  </div>
      
  <!-- About us Offcanvas -->
  <div class="offcanvas offcanvas-bottom rounded-3 bg-light" style="z-index: 10; height: 100vh;" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="about-us-offcanvas" aria-labelledby="offcanvasScrollingLabel">
    <div class="offcanvas-header light shadow-sm">
      <h4>Sobre nós</h4>
      <button type="button" class="btn-close text-reset position-absolute end-0 translate-middle-x" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
      <p> Toda informação sobre nos </p>
    </div>
  </div>
    
  <!-- List Properties Sidebar -->
  <div class="offcanvas offcanvas-start bg-light rounded-3 border-0 shadow-sm" style="z-index: 10;" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="list-properties" aria-labelledby="offcanvasScrollingLabel">
    <div class="offcanvas-header light shadow-sm">
      <a type="button" class="btn-close text-reset position-absolute end-0 translate-middle-x" data-bs-dismiss="offcanvas" aria-label="Close"></a>
    </div>
    <div class="offcanvas-body ">
      <div class="row">
        <div class="col-md-4 col-sm-12">
          <div class="row flex-column">
            <div class="col-12">
              <div id="usr_list_terrain_scollspy" class="row light rounded-3 m-1 p-3 shadow-sm">
                <h5 class="mb-3">Lista de Terrenos</h5>
                <div class="row d-flex flex-row justify-content-center p-0" id="usr_terrain_count" data-app-value=0>
                </div>
                
    
              </div>
            </div>
            <div class="col-12">
              
            </div>
          </div>
        </div>
        <div class="col-md-5 col-sm-12">
          <div class="row flex-column" id="usr_terrain_menu">
            <div class="col-12">
              <div id="usr_pending_terrain_scrollpsy" class="row light rounded-3 m-1 p-3 shadow-sm" data-app-value=0>

                <div class="row flex-row mb-3">
                  <div class="col">
                    <h5 class="">Pedidos Pendentes</h5>
                  </div>
                  <div class="col">
                    <div class="d-flex flex-fill justify-content-end align-items-center">
                      <a href="#" type="button" onclick="togglePolygonDrawingControl(true)" class="btn btn-primary rounded-pill text-white d-flex align-items-center" style="border: none !important;" data-bs-toggle="offcanvas" data-bs-target="#request-terrain-offcanvas" aria-controls="offcanvasScrolling" data-tooltip="Adicionar uma Propriedade">
                        Registar terreno
                      </a>
                    </div>
                    <!--<input type="button" onclick="togglePolygonDrawingControl(true)" class="btn btn-primary rounded-pill" value="Registar novo terreno"> -->
                    
                  </div>
                </div>
                
                <div class="row d-flex flex-row justify-content-center" id="usr_pending_terrain_list">
                </div>
    
                <!-- No Properties? -->
                <div id="no_pending_requests">
                  <p class="text-center"></p>
                </div>
                
                <!-- Add New Property Button --> 
                <div class="d-flex flex-row justify-content-center">
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-3 col-sm-12">
          <div class="row flex-column">
            <div class="col-12">
              <div class="light rounded-3 m-1 p-3 shadow-sm">
                <h5>Camadas</h5>
                <div class="row flex-md-column flex-sm-row">
                  
                  <div class="col-md-12 col-sm-6">
                    <div class="light rounded-3 shadow-sm m-2 p-3" style="">
                      <div class="d-flex flex-row justify-content-center align-items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" class="bi bi-brightness-high-fill text-warning me-3" viewBox="0 0 16 16">
                          <path d="M12 8a4 4 0 1 1-8 0 4 4 0 0 1 8 0zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
                        </svg>
                        <div class="form-check form-switch ms-3">
                          <input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault">
                        </div>
                      </div>
                      
                    </div>
                  </div>

                  <div class="col-md-12 col-sm-6">
                    <div class="light rounded-3 shadow-sm m-2 p-3" style="">
                      <div class="d-flex flex-row justify-content-center align-items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" class="bi bi-exclamation-square-fill text-danger me-3" viewBox="0 0 16 16">
                          <path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm6 4c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995A.905.905 0 0 1 8 4zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
                        </svg>
                        <div class="ms-3 form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault">
                        </div>
                      </div>
                      
                    </div>
                  </div>
                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row" >
        <div class="col-md-6 col-sm-12">
          
        </div>
        <div class="col-md-6 col-sm-12">
          
        </div>


      </div>
    </div>
  </div>

  <!-- Request Terrain Sidebar -->
  <div class="offcanvas offcanvas-end rounded-3 bg-light border-0 shadow-sm" style="z-index: 10;" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="request-terrain-offcanvas" aria-labelledby="offcanvasScrollingLabel" data-expand="true">
    <div class="offcanvas-header position-relative light shadow-sm">
      <h5 class="offcanvas-title" id="offcanvasScrollingLabel">Novo Terreno</h5> 
      <button id="request-terrain-btn-close" type="button" class="btn-close text-reset" onclick="toggleDrawing(false)" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      <button id="request-terrain-btn-expand" class="position-absolute translate-middle-x start-50 btn border-0 text-reset" onclick="toggleExpandOffcanvas('request-terrain-offcanvas')">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-chevron-bar-down" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M3.646 4.146a.5.5 0 0 1 .708 0L8 7.793l3.646-3.647a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 0-.708zM1 11.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13a.5.5 0 0 1-.5-.5z"/>
        </svg>
      </button>
    </div>
    <div class="offcanvas-body">
      <div class="alert alert-success shadow-sm" role="alert">
        <p>Crie novos pontos no mapa para delimitar a <strong>região que pretende registar</strong>.</p>
      </div>
      <div class="light p-3 mb-3 rounded-3 shadow-sm">
        <div class="light p-3 mb-3 rounded-3 shadow-sm">
          <h5 class="mb-3">Sobre o terreno</h5>
          <div class="mb-3">
            <label for="name-terrain" class="form-label">Nome do Terreno</label>
            <input type="text" class="form-control rounded-pill" id="name-terrain">
          </div>
          <div class="mb-3">
            <label for="district-terrain" class="form-label">Distrito</label>
            <input type="text" class="form-control rounded-pill" id="district-terrain">
          </div>
          <div class="mb-3">
            <label for="townhall-terrain" class="form-label">Concelho</label>
            <input type="text" class="form-control rounded-pill" id="townhall-terrain">
          </div>
          <div class="mb-3">
            <label for="section-terrain" class="form-label">Número de Artigo</label>
            <input type="text" class="form-control rounded-pill" id="section-terrain">
          </div>
          <div class="mb-3">
            <label for="number-article-terrain" class="form-label">Número de Secção</label>
            <input type="text" class="form-control rounded-pill" id="number-article-terrain">
          </div>
          <div class="mb-3">
            <label for="documentation-validation-terrain" class="form-label">Documentos de Validação do Terreno</label>
            <input type="file" class="form-control rounded-pill" id="documentation-validation-terrain" accept="application/pdf, application/vnd.openxmlformats-officedocument.wordprocessingml.document, application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" onchange="loadDocumentationFiles(event)" multiple>
          </div>
          <div class="mb-3">
            <label for="type_of_terrain_select" class="form-label">Tipo de Terreno</label>
            <select id="type_of_terrain_select" class="form-select" onchange="typeTerrain('type_of_terrain_select', 'other_type_of_terrain_checked')">
              <option value="empty" selected>Vazio</option>
              <option value="habitation">Habitação</option>
              <option value="cultivation">Cultivo</option>
              <option value="business">Empresarial/Adminstrativo</option>
              <option value="cultivation">Ensino</option>
              <option value="commerce">Comércio</option>
              <option value="hospital">Hospitalar</option>
              <option value="infrastructure">Estrada/Infraestrutura</option>
              <option value="other">Outro</option>
            </select>
          </div>
          <div id="other_type_of_terrain_checked" class="mb-3" data-app-menu-active="false">
            <div class="mb-3">
              <input type="text" class="form-control rounded-pill" id="other_type_of_terrain">
            </div>
          </div>
        </div>
        
        <div id="terrain_owners">
          <div class="light p-3 mb-3 rounded-3 shadow-sm">
            <h5 class="mb-3">Proprietário</h5>
            <div class="d-flex flex-column justify-content-center mb-3">
              <div class="form-check m-1">
                <input class="form-check-input" type="radio" name="acc_terrain" id="this_acc_terrain_option" onclick="setMenuID('other_acc_terrain_checked', 'false')" checked>
                <label class="form-check-label" for="this_acc_terrain_option">
                  Esta conta
                </label>
              </div>
              <div class="form-check m-1">
                <input class="form-check-input" type="radio" name="acc_terrain" id="other_acc_terrain_option" onclick="setMenuID('other_acc_terrain_checked', 'true')">
                <label class="form-check-label" for="other_acc_terrain_option">
                  Outra conta/pessoa
                </label>
              </div>
            </div>
            <div id="other_acc_terrain_checked" data-app-menu-active="false">
              <label for="other_acc_fullname_input" class="form-label">Nome Completo</label>
              <input id="other_acc_fullname_input" class="form-control rounded-pill mb-3" value=""></input>
              <label for="other_acc_id_input" class="form-label">NIF</label>
              <input id="other_acc_id_input" class="form-control rounded-pill mb-3" value=""></input>
              <label for="other_acc_telephone_input" class="form-label">Número de telefone</label>
              <input id="other_acc_telephone_input" class="form-control rounded-pill mb-3" value=""></input>
              <label for="other_acc_smartphone_input" class="form-label">Número de smartphone</label>
              <input id="other_acc_smartphone_input" class="form-control rounded-pill mb-3" value=""></input>
              <label for="other_acc_address_input" class="form-label">Morada</label>
              <input id="other_acc_address_input" class="form-control rounded-pill" value=""></input>
              <br>
            </div>
            
          </div>
  
        </div>
        <!--
           <div class="light p-3 mb-3 rounded-3 shadow-sm">
          <div class="d-flex flex-row justify-content-center align-items-center">
            <a href="#" type="button" class="text-reset">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-person-plus-fill" viewBox="0 0 16 16">
                <path d="M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                <path fill-rule="evenodd" d="M13.5 5a.5.5 0 0 1 .5.5V7h1.5a.5.5 0 0 1 0 1H14v1.5a.5.5 0 0 1-1 0V8h-1.5a.5.5 0 0 1 0-1H13V5.5a.5.5 0 0 1 .5-.5z"/>
              </svg>
            </a>
          </div>
        </div>
         -->
       

        <div class="light p-3 mb-3 rounded-3 shadow-sm">
          <h5 class="mb-3">Informação Adicional</h5>
          <div class="mb-3">
            <label for="description-terrain" class="form-label">Descrição</label>
            <textarea class="form-control rounded-3" id="description-terrain" rows="2"></textarea>
          </div>
          <div class="mb-3">
            <label for="image-terrain" class="form-label">Fotos do Terreno</label>
            <input type="file" class="form-control rounded-pill" id="image-terrain" accept="image/jpeg, image/png" onchange="loadImageFiles(event)" multiple >
          </div>
          <div class="mb-3">
            <label for="type-terrain" class="form-label">Cobertura de Solo</label>
            <input type="text" class="form-control rounded-pill" id="type-terrain">
          </div>
          <div class="mb-3">
            <label for="current-use-terrain" class="form-label">Uso atual</label>
            <input type="text" class="form-control rounded-pill" id="current-use-terrain">
          </div>
          <div class="mb-3">
            <label for="previous-use-terrain" class="form-label">Uso anterior</label>
            <input type="text" class="form-control rounded-pill" id="previous-use-terrain">
          </div>
          <div class="mb-3">
            <label for="define-route-terrain" class="form-label">Caminho de entrada para o terreno</label>
            <br>
            <input id="define-route-terrain" type="button" class="btn btn-info rounded-pill text-light" value="Definir caminho" onclick="initRoute()">
          </div>
          
        </div>

        <div class="alert alert-info alert-dismissible shadow-sm" role="alert">
          <p>Certifique-se que preencheu os campos disponiveis de forma correta.</p>
          <strong>Não será possivel alterar os campos deste registo mais tarde.</strong>
          
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        <!-- Register Property Button --> 
        <div class="input-group center-x mt-3 mb-3" style=""> 
          <a id="redirect-request-property" type="button" style="width: 10rem;" class="btn btn-primary text-white center-x rounded-pill" onclick="submitPolygon()">
            Registar
            <span id="register_terrain_spinner" class="spinner-border spinner-border-sm" role="status" aria-hidden="true" data-app-menu-active="false"></span>
          </a>
        </div> 
      </div>
      
      
    </div>
  </div>

  <div id="route_definition_menu" class="app-popup" style="z-index: 100000;" data-app-menu-active="false">
    <div class="position-absolute translate-middle start-50">
      <div class="light rounded-pill p-1 shadow-sm" style="">
        <a type="button" class="btn text-reset me-1" onclick="terminateRoute(true)">
          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-check-lg" viewBox="0 0 16 16">
            <path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425a.247.247 0 0 1 .02-.022Z"/>
          </svg>
        </a>
        <a type="button" class="btn text-reset ms-1" onclick="terminateRoute(false)">
          <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16">
            <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>
          </svg>
        </a>
      </div>
    </div>
  </div>
  
  <!-- Terrain Properties Sidebar -->
  <div class="terrain-list">
    <div class="offcanvas offcanvas-start rounded-3" style="z-index: 10;" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="terrain-properties" aria-labelledby="offcanvasScrollingLabel">
      <div class="offcanvas-header light shadow-sm">
        <h4 id="terrain_name">Nome Terreno</h4>
        
        <button type="button" class="btn-close text-reset position-absolute end-0 translate-middle-x" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body bg-light">
        <div class="row">
          <div class="col-md-6 col-sm-12">
            <div class="row flex-column">
              <div class="col-12">
                <div class="light p-3 mb-3 rounded-3 shadow-sm">
                  <h5 class="mb-3">Informação</h5>
                  <h6>Concelho</h6>
                  <p class="border-bottom" id="terrain_townhall">-</p>
                  <h6>Distrito</h6>
                  <p class="border-bottom" id="terrain_district">-</p>
                  <h6>Número de Artigo</h6>
                  <p class="border-bottom" id="terrain_number_article">-</p>
                  <h6>Número de Secção</h6>
                  <p class="border-bottom" id="terrain_number_section">-</p>
                  <h6>Documentos de Validação</h6>
                  <select id="terrain_documents_validation" class="form-select" size="5">
                  </select>
                </div>
              </div>
              <div class="col-12">
                <div class="light p-3 mb-3 rounded-3 shadow-sm">
                  <h5 class="mb-3">Informação Adicional</h5>
                  <h6>Descrição</h6>
                  <p class="border rounded-3 p-3" id="terrain_description">-</p>
                  <h6>Cobertura de Solo</h6>
                  <p class="border-bottom" id="terrain_type">-</p>
                  <h6>Uso atual</h6>
                  <p class="border-bottom" id="terrain_current_use">-</p>
                  <h6>Uso anterior</h6>
                  <p class="border-bottom" id="terrain_previous_use">-</p>
                </div>
              </div>
            </div>
            
          </div>
          <div class="col-md-6 col-sm-12">
            <div class="row">
              <div class="col-12">
                <div class="light mb-3 p-3 rounded-3 shadow-sm">
                  <div class="d-flex flex-row mb-3 align-items-center">
                    <h5 class="me-3">Foto do terreno</h5>
                    <a type="button" class="btn text-reset me-3">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-map" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M15.817.113A.5.5 0 0 1 16 .5v14a.5.5 0 0 1-.402.49l-5 1a.502.502 0 0 1-.196 0L5.5 15.01l-4.902.98A.5.5 0 0 1 0 15.5v-14a.5.5 0 0 1 .402-.49l5-1a.5.5 0 0 1 .196 0L10.5.99l4.902-.98a.5.5 0 0 1 .415.103zM10 1.91l-4-.8v12.98l4 .8V1.91zm1 12.98 4-.8V1.11l-4 .8v12.98zm-6-.8V1.11l-4 .8v12.98l4-.8z"/>
                      </svg>
                    </a>
                  </div>
                  
                  <div id="carouselTerrainImages" class="carousel slide" data-bs-ride="carousel">
                    <div class="carousel-inner rounded-3" id="terrain_images">
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#carouselTerrainImages" data-bs-slide="prev">
                      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                      <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#carouselTerrainImages" data-bs-slide="next">
                      <span class="carousel-control-next-icon" aria-hidden="true"></span>
                      <span class="visually-hidden">Next</span>
                    </button>
                  </div>
                </div>
              </div>
              <div class="col-12">
                <div class="row flex-row">
                  <div class="col-4">
                    <div class="bg-info bg-opacity-10 rounded-3 p-3 shadow-sm w-100 h-75">
                      <p class="text-center">Temperatura Mínima</p>
                      <p class="display-6 text-center pb-3">0</p>
                    </div>
                  </div>
                  <div class="col-4">
                    <div class="bg-danger bg-opacity-10 rounded-3 p-3 shadow-sm w-100 h-75">
                      <p class="text-center">Temperatura Máxima</p>
                      <p id="terrain_min_temp" class="display-6 text-center pb-3">0</p>
                    </div>
                  </div>
                  <div class="col-4">
                    <div class="bg-danger bg-opacity-25 rounded-3 p-3 shadow-sm w-100 h-75">
                      <p class="text-center">Risco Incêndio</p>
                      <p id="terrain_rcm" class="display-6 text-center pb-3">0</p>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-12">
                <div class="light p-3 mb-3 rounded-3 shadow-sm">
                  <h5 class="mb-3">Proprietário</h5>
                  <h6>Nome Completo</h6>
                  <p id="owner_fullname" class="border-bottom">-</p>
                  <h6>NIF</h6>
                  <p id="owner_id" class="border-bottom">-</p>
                  <h6>Número de telefone</h6>
                  <p id="owner_telephone" class="border-bottom">-</p>
                  <h6>Número de smartphone</h6>
                  <p id="owner_smartphone" class="border-bottom">-</p>
                  <h6>Morada</h6>
                  <p id="owner_address" class="border-bottom">-</p>
                </div>
              </div>
            </div>
            
          </div>
        </div>

        <!-- Toast Handler-->
          
      </div>
    </div>
  </div>

  <script type="text/javascript">

  </script>
  <script type="text/javascript" src="app.js"></script>

  
</body>
</html>