<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Main App</title>

    <!-- BootStrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Google Maps -->
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/pure/0.6.2/pure-min.css">

    <!--Aplication-->
    <link href="./styles/main.css" rel="stylesheet">
    <link href="./styles/map.css" rel="stylesheet">

</head>
<body id="main" class="">
  <div id="loader" class="overlay none">
    <div class="lds-ring center"><div></div><div></div><div></div><div></div></div>
  </div>

  <!-- <Terrain> Properties Sidebar -->
    <div class="offcanvas offcanvas-start rounded-3" style="z-index: 10; left: 4rem; width: calc(100% - 4rem);" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="terrain-properties" aria-labelledby="offcanvasScrollingLabel">
      <div class="offcanvas-header">
        <h4>Property Name</h4>
        <button type="button" class="btn-close text-reset position-absolute end-0 translate-middle-x" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        
        <p>Description:</p>
        <p>Conselho:</p>
        <p>Freguesia:</p>
        <p>Section:</p>
        <p>Number Article:</p>
        <p>Verification:</p>

        <p>Other info of this terrain: Risco Incendio, Humidade, etc</p>
  
        <!-- Toast Handler-->
        
      </div>
    </div>

  <!-- Sidebar -->
  <div class="d-flex flex-column flex-shrink-0 bg-light rounded-3 position-absolute" style="width: 4rem; height: 100vh; z-index: 10; transition: opacity 100 ms linear;">
    <!-- Avatar Image -->
    <a href="#" class="nav-link d-flex align-items-center justify-content-center p-3 text-decoration-none" data-bs-toggle="offcanvas" data-bs-target="#user-properties">
      <div class="avatar-wrapper" style="width: 2rem; height: 2rem;">
        <img id="usr_avatar" src="./media/imgs/user.png" class="rounded-circle shadow-sm grow" style="">
      </div>
    </a>
    <ul class="nav nav-pills nav-flush flex-column mb-auto text-center border-top top-50">
      <li class="nav-item">

        <!-- Map Button -->
        <a href="#" class="nav-link py-3" aria-current="page" title="Mapa" data-bs-toggle="offcanvas" data-bs-placement="right">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-geo-alt-fill grow" viewBox="0 0 16 16">
            <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
          </svg>
        </a>
      </li>
      <li>

        <!-- Properties Button -->
        <a href="#" class="nav-link py-3" title="Listar Propriedades" data-bs-toggle="offcanvas" data-bs-target="#list-properties" aria-controls="offcanvasScrolling" data-bs-placement="right">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-journal-album grow" viewBox="0 0 16 16">
            <path d="M5.5 4a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 .5.5h5a.5.5 0 0 0 .5-.5v-5a.5.5 0 0 0-.5-.5h-5zm1 7a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1h-3z"/>
            <path d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"/>
            <path d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"/>
          </svg>     
        </a>
      </li>
      <li>

        <!-- Add Property Button -->
        <a href="#" id="request-property" class="nav-link py-3" title="Adicionar uma Propriedade" data-bs-toggle="offcanvas" data-bs-target="#request-terrain-offcanvas" aria-controls="offcanvasScrolling">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-send grow" viewBox="0 0 16 16">
            <path d="M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576 6.636 10.07Zm6.787-8.201L1.591 6.602l4.339 2.76 7.494-7.493Z"/>
          </svg>
        </a>
      </li>
    </ul>

    <!-- Settings Button -->
    <a href="#" class="nav-link p-3 text-center" title="Definições" data-bs-toggle="tooltip" data-bs-placement="right">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-gear-fill grow" viewBox="0 0 16 16">
        <path d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872l-.1-.34zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z"/>
      </svg>
    </a>

    <!-- Notifications Button -->
    <a href="#" class="nav-link py-3 text-center position-relative" title="Notificações" data-bs-toggle="tooltip" data-bs-placement="right">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-bell-fill grow" viewBox="0 0 16 16">
        <path d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2zm.995-14.901a1 1 0 1 0-1.99 0A5.002 5.002 0 0 0 3 6c0 1.098-.5 6-2 7h14c-1.5-1-2-5.902-2-7 0-2.42-1.72-4.44-4.005-4.901z"/>
      </svg>
      <span class="position-absolute translate-middle p-1 bg-danger border border-light rounded-circle">
        <span class="visually-hidden">New alerts</span>
      </span>
    </a>

    <!-- Logout Button -->
    <a href="#" class="nav-link p-3 text-center" title="Sair" onclick="location.href='./login.html'" data-bs-toggle="tooltip" data-bs-placement="right">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-box-arrow-right" viewBox="0 0 16 16">
        <path fill-rule="evenodd" d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0v2z"/>
        <path fill-rule="evenodd" d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"/>
      </svg>
    </a>    

    <!-- Help Button -->
    <a href="#" class="nav-link p-3 text-center border-top" title="Ajuda" data-bs-toggle="tooltip" data-bs-placement="right">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-journal-text grow" viewBox="0 0 16 16">
        <path d="M5 10.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"/>
        <path d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"/>
        <path d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"/>
      </svg>
    </a>
        
    <!-- About Us Button -->
    <a href="#" class="nav-link p-3 text-center" title="Sobre nós" data-bs-toggle="tooltip" data-bs-placement="right">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-info-circle-fill grow" viewBox="0 0 16 16">
        <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/>
      </svg>
    </a>    
    
    <!-- User Properties Sidebar -->
    <div class="offcanvas offcanvas-start rounded-3" style="z-index: -10; left: 4rem;" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-5" id="user-properties" aria-labelledby="offcanvasScrollingLabel">
      <div class="offcanvas-header justify-content-center position-relative">
        <div class="avatar-wrapper" style="width: 8rem; height: 8rem;">
          <img id="usr_avatar" src="./media/imgs/user.png" class="rounded-circle shadow-sm" style="">
        </div>
        <button type="button" class="btn-close text-reset position-absolute end-0 translate-middle-x" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <div class="pb-3 ps-1 border-bottom">
          <h3>Username</h3>
          <h5 class="">Email</h5>
          <span class="badge rounded-pill bg-primary">User</span>
          <span class="badge rounded-pill bg-danger">Alpha Tester</span>
          <span class="badge rounded-pill bg-warning">Beta Tester</span>
          <span class="badge rounded-pill bg-success">Premium</span>
          <span class="badge rounded-pill bg-dark">Nope</span>
          <span class="badge rounded-pill bg-dark">Placeholder</span>
          <span class="badge rounded-pill bg-dark">Placeholder</span>
          <span class="badge rounded-pill bg-dark">Not a Placeholder</span>
          <span class="badge rounded-pill bg-dark">Placeholder</span>
          <span class="badge rounded-pill bg-dark">Maybe a Placeholder?</span>


        </div>
        <p class="mt-3">Primeiro Nome:</p>
        <p>Último Nome:</p>
        <p>NIF:</p>
        <p>Número de telefone:</p>
        <p>Morada:</p>
        <!-- Toast Handler-->
        
      </div>
    </div>
    
    <!-- List Properties Sidebar -->
    <div class="offcanvas offcanvas-start rounded-3" style="z-index: -10; left: 4rem;" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="list-properties" aria-labelledby="offcanvasScrollingLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasScrollingLabel">List of Properties</h5>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <div class="card pb-3" style="width: 20rem;">
          <img src="./media/imgs/dark-blurry-gradient-haikei.png" class="card-img-top" alt=".">
          <div class="card-body">
            <h5 class="card-title">Property 1</h5>
            <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
            <a href="#" class="btn btn-primary">Go there</a>
            <a href="#" class="btn btn-primary" data-bs-toggle="offcanvas" data-bs-target="#terrain-properties" aria-controls="offcanvasStart">Info</a>
          </div>
        </div>
        <div class="card pb-3" style="width: 20rem;">
          <img src="./media/imgs/register-wallpaper.jpg" class="card-img-top" alt=".">
          <div class="card-body">
            <h5 class="card-title">Property 2</h5>
            <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
            <a href="#" class="btn btn-primary">Go there</a>
            <a href="#" class="btn btn-primary">Info</a>
          </div>
        </div>
        <p>Try scrolling the rest of the page to see this option in action.</p>
      </div>
    </div>

    <!-- Request Terrain Sidebar -->
    <div class="offcanvas offcanvas-end rounded-3" style="z-index: -10; width: 20rem;" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="request-terrain-offcanvas" aria-labelledby="offcanvasScrollingLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasScrollingLabel">Request Properties </h5>
        <button id="request-terrain-btn-close" type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <div class="mb-3">
          <label for="name-terrain" class="form-label">Nome do Terreno</label>
          <input type="text" class="form-control rounded-pill" id="name-terrain">
        </div>
        <div class="mb-3">
          <label for="description-terrain" class="form-label">Descrição</label>
          <textarea class="form-control" id="description-terrain" rows="3"></textarea>
        </div>
        <div class="mb-3">
          <label for="conselho-terrain" class="form-label">Conselho</label>
          <input type="text" class="form-control rounded-pill" id="conselho-terrain">
        </div>
        <div class="mb-3">
          <label for="freguesia-terrain" class="form-label">Freguesia</label>
          <input type="text" class="form-control rounded-pill" id="freguesia-terrain">
        </div>
        <div class="mb-3">
          <label for="section-terrain" class="form-label">Secção</label>
          <input type="text" class="form-control rounded-pill" id="section-terrain">
        </div>
        <div class="mb-3">
          <label for="number-article-terrain" class="form-label">Numero de Artigo</label>
          <input type="text" class="form-control rounded-pill" id="number-article-terrain">
        </div>
        <div class="mb-3">
          <label for="documentation-validation-terrain" class="form-label">Documentos de Validação do Terreno</label>
          <input type="file" class="form-control rounded-pill" id="documentation-validation-terrain">
        </div>
        <p>Try scrolling the rest of the page to see this option in action.</p>
      </div>
    </div>

  </div>
  </div>

  <div id="map" class="position-absolute"></div>
  <script src="./maps.js"></script>
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDFF-sduDxFSBjCD_C-leaSI-sTkoCNO6Y&callback=initMap"></script>
  
  <!-- Alerts -->
  <div id="request-property-alert" class="position-absolute bottom-0 start-50 translate-middle-x alert alert-primary d-none" role="alert">
    Crie novos pontos no mapa para delimitar a região que pretende delimitar.
  </div>

  <script type="text/javascript">
    
    let isRequest = false;

    function closeRequest(){
      document.getElementById("request-property-alert").classList.add("d-none");
      clearListeners(map, "click");
      clearTemporaryData();
    }

    function openRequest(){
      document.getElementById("request-property-alert").classList.remove("d-none");

      createPolygon("#00aaff");
    }

    const nav_links = document.querySelectorAll('.nav-link');

    nav_links.forEach(elem => {
      elem.addEventListener('click', function handleClick(event) {
        isRequest = false;
        closeRequest();
      });
    });

    const btn_close = document.querySelectorAll('.btn-close');

    btn_close.forEach(elem => {
      elem.addEventListener('click', function handleClick(event) {
        isRequest = false;
        closeRequest();
      });
    });

    document.getElementById("request-property").addEventListener("click", function(){
      isRequest = true;
      console.log(isRequest);

      if (isRequest) {
        openRequest();
      } else {
        closeRequest();
      }
    });
  </script>
  
</body>
</html>